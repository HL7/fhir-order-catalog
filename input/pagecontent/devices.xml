<div xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir ../../input-cache/schemas-r5/fhir-single.xsd">
  <br/>
  <p>Detailed specifications for catalogs of medical devices</p>
  <a name="DevicesResourcesProfiles"> </a>
  <h3>Resources and Profiles for all devices</h3>
  <p>The figure below shows the resources and profiles used to represent catalogs of medical devices.
  </p>
  <img src="DeviceCatalog.png" alt="Resources used by a catalog medical devices" width="1000px"/>
  <p>When method 1 is chosen by the custodian of the catalog of devices, the catalog
    references its items: the <a href="http://hl7.org/fhir/composition.html">Composition</a>
    resource constrained by the <a href="http://hl7.org/fhir/composition-catalog.html"> Catalog</a>
    profile to represent the whole catalog, references the items of this catalog from its
    Composition.section.entry elements.
  </p>
  <p>When method 2 is chosen instead, the catalog is referenced by its items: Each DeviceDefinition
    resource constrained by the <a href="StructureDefinition-DeviceModel.html"> DeviceModel</a> profile
	and representing an item of the catalog, references the <a href="http://hl7.org/fhir/composition.html">Composition</a> resource 
	constrained by the <a href="StructureDefinition-CatalogHeader.html"> CatalogHeader</a> profile to represent the header of the catalog header, which holds the general properties of the catalog.
  </p>
  <p>An item of the catalog describes a model or type of device, with its various identifiers, classifications, safety characteristics and properties, 
     instantiated as a <a href="http://hl7.org/fhir/devicedefinition.html">DeviceDefinition</a> resource
	 linked to a number of supporting resources providing further details.
  </p>
    <a name="DeviceSearchRetrieve"> </a>
  <h3>Searching and retrieving devices from the catalog</h3>
  <a name="DeviceSearchApproach"> </a>
  <h4>Searching Approaches</h4>
  <p> The key searcheable assets in a catalog of devices are the model of devices exposed to
    the consumers of the compendium as instances of <a href="http://hl7.org/fhir/devicedefintion.html"> DeviceDefinition</a>. 
  </p>
  <ul>
    <li><b>Two-step search</b>: A client application browsing the content of the compendium may wish
      to first get the overview of a collection of devices at first glance, and then retrieve the
      full details associated with the ones of interest. 
      In this case, the first query will perform a simple search on
        <i>DeviceDefinition</i> with the desirable criteria listed in the table below ; and then a
      second narrower search will add the <b><code>_include:iterate=*</code></b> parameter, to retrieve the
      selected <i>DeviceDefinition</i> resource(s) with their supporting resources (<i>ClinicalUseDefinition</i>, <i>ChargeItemDefinition</i>)
      in the <i>searchset Bundle</i>.
	</li>
    <li><b>One-step search</b>: Conversely a client application may wish to retrieve the full
      details of a device (or a small collection of devices) at first glance. In this case, it uses the
      appropriate search criteria for <i>DeviceDefinition</i>, in combination with the <b><code>_include:iterate=*</code></b> parameter 
	  so as to obtain all the supporting resources of each device retrieved, in the <i>searchset Bundle</i>.
	</li>
  </ul>
  <p>Catalog servers may limit the iteration depth to an appropriate level for performance sake.</p>
  <a name="DeviceSearchParameters"> </a>
  <h4>Search Parameters for models of devices (DeviceDefinition)</h4>
    <table border="1">
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Expression</th>
        <th>Comment</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>_lastUpdated</td>
        <td>date</td>
        <td>Last system point in time of the DeviceDefinition instance</td>
        <td/>
        <td>can be used with =gt...</td>
      </tr>
      <tr>
        <td>class</td>
        <td>token</td>
        <td>specific class of models of devices</td>
        <td>DeviceDefinition.classification.type</td>
        <td>For instance device class in GMDN or in EMDN</td>
      </tr>
	  <tr>
        <td>udi</td>
        <td>token</td>
        <td>The primary UDI of the device model</td>
        <td>DeviceDefinition.udiDeviceIdentifier.deviceIdentifier</td>
        <td/>
      </tr>
	  <tr>
        <td>packaging-udi</td>
        <td>token</td>
        <td>The primary UDI of the package containing the device</td>
        <td>DeviceDefinition.packaging.udiDeviceIdentifier.deviceIdentifier</td>
        <td/>
      </tr>
      <tr>
        <td>identifier</td>
        <td>token</td>
        <td>A business identifier (other than the primary UDI) of the device</td>
        <td>DeviceDefinition.identifier</td>
        <td/>
      </tr>
      <tr>
        <td>model-number</td>
        <td>string</td>
        <td>The model number of the device</td>
        <td>DeviceDefinition.modelNumber</td>
        <td/>
      </tr>	  
	  <tr>
        <td>name</td>
        <td>string</td>
        <td>a name of the model of device</td>
        <td>DeviceDefinition.deviceName.name</td>
        <td>A device may have more than one name.</td>
      </tr>
      <tr>
        <td>catalog</td>
        <td>reference</td>
        <td>The reference to a Composition resource (profiled by CatalogHeader) owning this item</td>
        <td>DeviceDefinition.extension.where(url='http://hl7.org/fhir/uv/order-catalog/StructureDefinition/CatalogReference').valueReference.reference(Composition)</td>
        <td>catalog to search from</td>
      </tr>

    </tbody>
  </table>
   <a name="DeviceSearchExamples"> </a>
  <h4>Examples of searching and retrieving devices from catalogs</h4>
  <p>In all examples below, [base] represents the endpoint of the catalog server. The answer of the server comes as a Bundle of type 'searchset' encapsulating the resources selected by the search.</p>
  <p>One particular device compendium, is assumed to have Composition.id "a1" on the server.</p>
  <a name="AllCatalogs"> </a>
  <h5>List all catalogs of the server</h5>
  <pre>GET [base]/Composition?type:text=Catalog&amp;_summary=true</pre>
  <p> Obtains the summary of every catalog available on the server.The anwser Bundle contains one entry with a Composition resource for each catalog found.</p>
  <a name="AllDeviceCatalogs"> </a>
  <h5>List all device catalogs</h5>
  <pre>GET [base]/Composition?type:text=Catalog&amp;category=device&amp;_summary=true</pre>
  <p> Obtains the summary of each catalog of devices available on the server. The anwser Bundle contains one entry with a Composition resource for each device catalog found.</p>
  <a name="OneDeviceWithinOneCatalog"> </a>
  <h5>Retrieve all details for a device model</h5>
  <pre>GET [base]/DeviceDefinition?modelNumber=SCF332&amp;_include:iterate=*</pre>
  <p> Obtains the full content of instances of DeviceDefinition with modelNumber = "SCF332" accompanied by their supporting resources. 
	The anwser Bundle contains the full details for each:
	An entry for each matching DeviceDefinition and, below it, as many entries as resources referenced by this one (recursively). 
  </p> 
  <a name="LIVDResourcesProfiles"> </a>
  <h3>Resources and Profiles for IVD testing devices</h3>
  <p>See the <a href="https://build.fhir.org/ig/HL7/livd/"> LIVD Implementation Guide </a> 
  </p>
</div>
